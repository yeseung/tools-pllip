<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Google Analytics -->
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=G-Y4NESGBMLL"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());
      gtag("config", "G-Y4NESGBMLL");
    </script>

    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>Kelly Criterion Calculator - MyTools</title>
    <meta
      name="description"
      content="Kelly Criterion calculator. Calculate optimal investment ratio based on win probability and odds."
    />
    <meta
      name="keywords"
      content="kelly criterion, betting calculator, investment ratio, bankroll management"
    />

    <!-- Open Graph / SNS Í≥µÏú† -->
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Kelly Criterion Calculator" />
    <meta
      property="og:description"
      content="Kelly Criterion calculator. Calculate optimal investment ratio based on win probability and odds."
    />
    <meta property="og:url" content="https://tools.pllip.com/en/kelly/" />
    <meta property="og:site_name" content="MyTools" />
    <meta property="og:locale" content="en_US" />

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Kelly Criterion Calculator" />
    <meta
      name="twitter:description"
      content="Kelly Criterion calculator. Calculate optimal investment ratio based on win probability and odds."
    />

    <!-- Canonical URL -->
    <link rel="canonical" href="https://tools.pllip.com/en/kelly/" />

    <!-- Alternate language links -->

    <link rel="alternate" hreflang="ko" href="https://tools.pllip.com/kelly/" />
    <link
      rel="alternate"
      hreflang="en"
      href="https://tools.pllip.com/en/kelly/"
    />
    <link
      rel="alternate"
      hreflang="x-default"
      href="https://tools.pllip.com/kelly/"
    />

    <!-- Íµ¨Ï°∞ÌôîÎêú Îç∞Ïù¥ÌÑ∞ -->
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "WebSite",
        "name": "tools.pllip.com",
        "alternateName": "Online Tools",
        "url": "https://tools.pllip.com/en/",
        "description": "Free online tools collection. IP address lookup, QR code generator, JSON/XML formatter, Markdown viewer, Base64 converter, and regex tester.",
        "inLanguage": "en",
        "potentialAction": {
          "@type": "SearchAction",
          "target": {
            "@type": "EntryPoint",
            "urlTemplate": "https://tools.pllip.com/en/?q={search_term_string}"
          },
          "query-input": "required name=search_term_string"
        }
      }
    </script>

    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "Kelly Criterion Calculator",
        "description": "Calculate optimal betting/investment ratio",
        "url": "https://tools.pllip.com/en/kelly/",
        "applicationCategory": "UtilitiesApplication",
        "operatingSystem": "Any",
        "inLanguage": "en",
        "offers": {
          "@type": "Offer",
          "price": "0",
          "priceCurrency": "USD"
        },
        "isPartOf": {
          "@type": "WebSite",
          "name": "tools.pllip.com",
          "url": "https://tools.pllip.com"
        }
      }
    </script>

    <link rel="stylesheet" href="/css/style.css?v=80f21ced" />
  </head>
  <body>
    <header>
      <nav>
        <a href="/en/" class="logo"
          ><span class="logo-full">tools.pllip.com</span
          ><span class="logo-short">tools</span></a
        >
        <div class="nav-wrapper">
          <button class="nav-arrow nav-prev" aria-label="Previous">
            &#8249;
          </button>
          <ul id="nav-menu">
            <li><a href="/en/ip/">IP Check</a></li>

            <li><a href="/en/qr/">QR Code</a></li>

            <li><a href="/en/json/">JSON</a></li>

            <li><a href="/en/xml/">XML</a></li>

            <li><a href="/en/md/">Markdown</a></li>

            <li><a href="/en/base64/">Base64</a></li>

            <li><a href="/en/regex/">Regex</a></li>

            <li><a href="/en/uuid/">UUID</a></li>

            <li><a href="/en/hash/">Hash</a></li>

            <li><a href="/en/ladder/">Ladder</a></li>

            <li><a href="/en/kelly/" class="active">Kelly</a></li>

            <li><a href="/en/sudoku/">Sudoku</a></li>

            <li><a href="/en/loan/">Loan</a></li>
          </ul>
          <button class="nav-arrow nav-next" aria-label="Next">&#8250;</button>
        </div>
        <div class="nav-search">
          <button class="search-btn" id="search-btn" aria-label="Search">
            <svg
              width="18"
              height="18"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <circle cx="11" cy="11" r="8" />
              <path d="m21 21-4.35-4.35" />
            </svg>
          </button>
          <div class="search-dropdown" id="search-dropdown">
            <input
              type="text"
              id="header-search"
              placeholder="Search tools..."
              autocomplete="off"
            />
            <ul id="search-results">
              <li>
                <a
                  href="/en/ip/"
                  data-keywords="ip address ipv4 ipv6 myip whatismyip location lookup IP Address Lookup IP Check"
                  >üåê IP Address Lookup</a
                >
              </li>

              <li>
                <a
                  href="/en/qr/"
                  data-keywords="qr code barcode wifi vcard generator create QR Code Generator QR Code"
                  >üì± QR Code Generator</a
                >
              </li>

              <li>
                <a
                  href="/en/json/"
                  data-keywords="json formatter beautify minify validate parser JSON Formatter JSON"
                  >{ } JSON Formatter</a
                >
              </li>

              <li>
                <a
                  href="/en/xml/"
                  data-keywords="xml formatter beautify html xhtml convert json XML Formatter XML"
                  >&lt;/&gt; XML Formatter</a
                >
              </li>

              <li>
                <a
                  href="/en/md/"
                  data-keywords="markdown md preview editor github readme Markdown Viewer Markdown"
                  >M‚Üì Markdown Viewer</a
                >
              </li>

              <li>
                <a
                  href="/en/base64/"
                  data-keywords="base64 encode decode encoder decoder converter Base64 Converter Base64"
                  >B64 Base64 Converter</a
                >
              </li>

              <li>
                <a
                  href="/en/regex/"
                  data-keywords="regex regexp regular expression pattern tester Regex Tester Regex"
                  >.* Regex Tester</a
                >
              </li>

              <li>
                <a
                  href="/en/uuid/"
                  data-keywords="uuid guid unique id generator random UUID Generator UUID"
                  ># UUID Generator</a
                >
              </li>

              <li>
                <a
                  href="/en/hash/"
                  data-keywords="hash md5 sha1 sha256 sha512 checksum generator Hash Generator Hash"
                  >## Hash Generator</a
                >
              </li>

              <li>
                <a
                  href="/en/ladder/"
                  data-keywords="ladder game random picker lottery selection Ladder Game Ladder"
                  >ü™ú Ladder Game</a
                >
              </li>

              <li>
                <a
                  href="/en/kelly/"
                  data-keywords="kelly criterion betting investment ratio bankroll odds Kelly Criterion Calculator Kelly"
                  >üìä Kelly Criterion Calculator</a
                >
              </li>

              <li>
                <a
                  href="/en/sudoku/"
                  data-keywords="sudoku puzzle number game brain logic solver hints Sudoku Sudoku"
                  >9 Sudoku</a
                >
              </li>

              <li>
                <a
                  href="/en/loan/"
                  data-keywords="loan calculator repayment mortgage amortization interest rate debt payoff strategy Loan Repayment Calculator Loan"
                  >üí∞ Loan Repayment Calculator</a
                >
              </li>
            </ul>
          </div>
        </div>
      </nav>
    </header>

    <main>
      <div class="kelly-container">
        <div class="kelly-info">
          <p>
            The Kelly Criterion is a formula for calculating the optimal
            betting/investment ratio to maximize long-term wealth.
          </p>
          <div class="kelly-formula">
            <strong>Formula:</strong> f* = (bp - q) / b
            <div class="formula-legend">
              <span>f* = Optimal investment ratio</span>
              <span>b = Odds (net return rate)</span>
              <span>p = Win probability</span>
              <span>q = Lose probability (1-p)</span>
            </div>
          </div>
        </div>

        <div class="kelly-mode-toggle">
          <button
            class="mode-btn active"
            data-mode="simple"
            onclick="setMode('simple')"
          >
            Simple Mode
          </button>
          <button
            class="mode-btn"
            data-mode="advanced"
            onclick="setMode('advanced')"
          >
            Advanced Mode
          </button>
        </div>

        <!-- Simple Mode -->
        <div class="kelly-inputs" id="simple-inputs">
          <div class="input-group">
            <label for="win-prob">Win Probability (%)</label>
            <input
              type="number"
              id="win-prob"
              min="0"
              max="100"
              step="0.1"
              value="60"
              placeholder="60"
            />
            <span class="input-hint">Probability of winning (0-100%)</span>
          </div>

          <div class="input-group">
            <label for="odds">Win Amount</label>
            <input
              type="number"
              id="odds"
              min="0"
              step="1"
              value="200"
              placeholder="200"
            />
            <span class="input-hint"
              >Amount received on 100 bet if you win (e.g., 200 = 2.0
              odds)</span
            >
          </div>

          <div class="input-group">
            <label for="bankroll">Total Bankroll (optional)</label>
            <input
              type="number"
              id="bankroll"
              min="0"
              step="1"
              placeholder="1000000"
            />
            <span class="input-hint"
              >Enter your bankroll to see recommended bet amount</span
            >
          </div>
        </div>

        <!-- Advanced Mode -->
        <div class="kelly-inputs" id="advanced-inputs" style="display: none">
          <div class="advanced-info">
            <p>
              Enter multiple outcomes with their probabilities and returns.
              Probabilities must sum to 100%.
            </p>
          </div>

          <div class="input-group">
            <label for="adv-bankroll">Total Bankroll </label>
            <input
              type="number"
              id="adv-bankroll"
              min="0"
              step="1"
              value="1000000"
              placeholder="1000000"
            />
          </div>

          <div class="outcomes-section">
            <h4>Outcome Scenarios</h4>
            <div id="outcomes-container">
              <div class="outcome-row" data-index="0">
                <input
                  type="text"
                  class="outcome-name"
                  value="Win"
                  placeholder="Outcome"
                />
                <input
                  type="number"
                  class="outcome-prob"
                  min="0"
                  max="100"
                  step="0.1"
                  value="40"
                  placeholder="Prob%"
                />
                <button
                  class="remove-outcome-btn"
                  onclick="removeOutcome(this)"
                >
                  &times;
                </button>
              </div>
              <div class="outcome-row" data-index="1">
                <input
                  type="text"
                  class="outcome-name"
                  value="Draw"
                  placeholder="Outcome"
                />
                <input
                  type="number"
                  class="outcome-prob"
                  min="0"
                  max="100"
                  step="0.1"
                  value="30"
                  placeholder="Prob%"
                />
                <button
                  class="remove-outcome-btn"
                  onclick="removeOutcome(this)"
                >
                  &times;
                </button>
              </div>
              <div class="outcome-row" data-index="2">
                <input
                  type="text"
                  class="outcome-name"
                  value="Lose"
                  placeholder="Outcome"
                />
                <input
                  type="number"
                  class="outcome-prob"
                  min="0"
                  max="100"
                  step="0.1"
                  value="30"
                  placeholder="Prob%"
                />
                <button
                  class="remove-outcome-btn"
                  onclick="removeOutcome(this)"
                >
                  &times;
                </button>
              </div>
            </div>
            <button class="add-row-btn" onclick="addOutcome()">
              + Add Outcome
            </button>
            <div class="prob-total">
              Probability Total: <span id="prob-total">100</span>%
            </div>
          </div>

          <div class="bets-section">
            <h4>Betting Options</h4>
            <p class="section-hint">
              Enter the amount received per 100 bet (e.g., 150 for win, 80 for
              lose)
            </p>
            <div id="bets-container"></div>
            <button class="add-row-btn" onclick="addBet()">+ Add Bet</button>
          </div>
        </div>

        <div class="kelly-actions">
          <button class="btn btn-primary" onclick="calculate()">
            Calculate
          </button>
          <button class="btn btn-secondary" onclick="resetForm()">Reset</button>
        </div>

        <div class="kelly-error" id="error-msg"></div>

        <div class="kelly-result" id="result">
          <div class="result-main">
            <div class="result-item">
              <span class="result-label">Kelly Ratio</span>
              <span class="result-value" id="kelly-percent">-</span>
            </div>
            <div class="result-item">
              <span class="result-label">Recommended Bet</span>
              <span class="result-value" id="bet-amount">-</span>
            </div>
          </div>

          <div class="result-variants">
            <h4>Kelly Variants</h4>
            <div class="variant-grid">
              <div class="variant-item">
                <span class="variant-label">Full Kelly (100%)</span>
                <span class="variant-value" id="full-kelly">-</span>
              </div>
              <div class="variant-item">
                <span class="variant-label">Half Kelly (50%)</span>
                <span class="variant-value" id="half-kelly">-</span>
              </div>
              <div class="variant-item">
                <span class="variant-label">Quarter Kelly (25%)</span>
                <span class="variant-value" id="quarter-kelly">-</span>
              </div>
            </div>
          </div>

          <div class="result-analysis" id="analysis"></div>
        </div>

        <div class="kelly-note">
          <h4>Notes</h4>
          <ul>
            <li>
              <strong>Full Kelly</strong>: Mathematically optimal but high
              volatility
            </li>
            <li>
              <strong>Half Kelly</strong>: Commonly used in practice, 75% less
              volatility
            </li>
            <li>
              <strong>Negative result</strong>: Don&#39;t bet (negative expected
              value)
            </li>
            <li>
              Kelly Criterion is only valid when probability and odds are
              accurate
            </li>
          </ul>
        </div>
      </div>

      <style>
        .kelly-container {
          max-width: 600px;
          margin: 0 auto;
        }
        .kelly-info {
          background: var(--card-bg);
          border: 1px solid var(--border);
          border-radius: 12px;
          padding: 1.5rem;
          margin-bottom: 1.5rem;
        }
        .kelly-info p {
          margin-bottom: 1rem;
          color: var(--text-muted);
        }
        .kelly-formula {
          background: var(--bg);
          border-radius: 8px;
          padding: 1rem;
          font-family: monospace;
        }
        .formula-legend {
          display: flex;
          flex-wrap: wrap;
          gap: 0.5rem 1.5rem;
          margin-top: 0.75rem;
          font-size: 0.85rem;
          color: var(--text-muted);
        }
        .kelly-inputs {
          background: var(--card-bg);
          border: 1px solid var(--border);
          border-radius: 12px;
          padding: 1.5rem;
          margin-bottom: 1.5rem;
        }
        .input-group {
          margin-bottom: 1.25rem;
        }
        .input-group:last-child {
          margin-bottom: 0;
        }
        .input-group label {
          display: block;
          font-weight: 600;
          margin-bottom: 0.5rem;
        }
        .input-group input {
          width: 100%;
          padding: 0.75rem 1rem;
          border: 1px solid var(--border);
          border-radius: 8px;
          font-size: 1rem;
        }
        .input-group input:focus {
          outline: none;
          border-color: var(--primary);
        }
        .input-hint {
          display: block;
          font-size: 0.8rem;
          color: var(--text-muted);
          margin-top: 0.35rem;
        }
        .kelly-actions {
          display: flex;
          gap: 1rem;
          justify-content: center;
          margin-bottom: 1.5rem;
        }
        .kelly-result {
          background: var(--card-bg);
          border: 1px solid var(--border);
          border-radius: 12px;
          padding: 1.5rem;
          margin-bottom: 1.5rem;
        }
        .result-main {
          display: grid;
          grid-template-columns: 1fr 1fr;
          gap: 1rem;
          margin-bottom: 1.5rem;
        }
        .result-item {
          text-align: center;
          padding: 1rem;
          background: var(--bg);
          border-radius: 8px;
        }
        .result-label {
          display: block;
          font-size: 0.85rem;
          color: var(--text-muted);
          margin-bottom: 0.5rem;
        }
        .result-value {
          display: block;
          font-size: 1.75rem;
          font-weight: 700;
          color: var(--primary);
        }
        .result-value.negative {
          color: var(--error);
        }
        .result-value.positive {
          color: var(--success);
        }
        .result-variants h4 {
          margin-bottom: 0.75rem;
          font-size: 0.95rem;
        }
        .variant-grid {
          display: grid;
          grid-template-columns: repeat(3, 1fr);
          gap: 0.75rem;
        }
        @media (max-width: 500px) {
          .variant-grid {
            grid-template-columns: 1fr;
          }
          .result-main {
            grid-template-columns: 1fr;
          }
        }
        .variant-item {
          text-align: center;
          padding: 0.75rem;
          background: var(--bg);
          border-radius: 6px;
        }
        .variant-label {
          display: block;
          font-size: 0.75rem;
          color: var(--text-muted);
          margin-bottom: 0.25rem;
        }
        .variant-value {
          font-weight: 600;
        }
        .result-analysis {
          margin-top: 1.25rem;
          padding: 1rem;
          border-radius: 8px;
          font-size: 0.9rem;
        }
        .result-analysis.positive {
          background: rgba(34, 197, 94, 0.1);
          border: 1px solid rgba(34, 197, 94, 0.3);
          color: var(--success);
        }
        .result-analysis.negative {
          background: rgba(239, 68, 68, 0.1);
          border: 1px solid rgba(239, 68, 68, 0.3);
          color: var(--error);
        }
        .result-analysis.neutral {
          background: rgba(245, 158, 11, 0.1);
          border: 1px solid rgba(245, 158, 11, 0.3);
          color: #d97706;
        }
        .kelly-note {
          background: var(--card-bg);
          border: 1px solid var(--border);
          border-radius: 12px;
          padding: 1.5rem;
        }
        .kelly-note h4 {
          margin-bottom: 0.75rem;
        }
        .kelly-note ul {
          margin: 0;
          padding-left: 1.25rem;
        }
        .kelly-note li {
          margin-bottom: 0.5rem;
          color: var(--text-muted);
          font-size: 0.9rem;
        }
        .kelly-note li:last-child {
          margin-bottom: 0;
        }
        .kelly-mode-toggle {
          display: flex;
          justify-content: center;
          gap: 0.5rem;
          margin-bottom: 1.5rem;
        }
        .mode-btn {
          padding: 0.6rem 1.5rem;
          border: 1px solid var(--border);
          background: var(--card-bg);
          border-radius: 8px;
          cursor: pointer;
          font-size: 0.9rem;
          transition: all 0.2s;
        }
        .mode-btn:hover {
          border-color: var(--primary);
        }
        .mode-btn.active {
          background: var(--primary);
          color: white;
          border-color: var(--primary);
        }
        .advanced-info {
          background: var(--bg);
          padding: 1rem;
          border-radius: 8px;
          margin-bottom: 1rem;
          font-size: 0.9rem;
          color: var(--text-muted);
        }
        .outcomes-section,
        .bets-section {
          margin-top: 1.5rem;
          padding-top: 1rem;
          border-top: 1px solid var(--border);
          overflow-x: auto;
        }
        .outcomes-section h4,
        .bets-section h4 {
          margin-bottom: 0.75rem;
        }
        .section-hint {
          font-size: 0.8rem;
          color: var(--text-muted);
          margin-bottom: 0.75rem;
        }
        .outcome-row,
        .bet-row {
          display: flex;
          gap: 0.5rem;
          margin-bottom: 0.5rem;
          align-items: center;
          min-width: max-content;
        }
        .outcome-row input,
        .bet-row input {
          padding: 0.5rem;
          border: 1px solid var(--border);
          border-radius: 6px;
          font-size: 0.9rem;
        }
        .outcome-name {
          flex: 1;
          min-width: 80px;
        }
        .outcome-prob {
          width: 80px;
        }
        .bet-row .bet-name {
          width: 100px;
        }
        .bet-row .bet-return {
          width: 70px;
          text-align: center;
        }
        .remove-outcome-btn,
        .remove-bet-btn {
          width: 32px;
          height: 32px;
          border: 1px solid var(--border);
          background: var(--card-bg);
          border-radius: 6px;
          cursor: pointer;
          color: var(--text-muted);
          font-size: 1.1rem;
        }
        .remove-outcome-btn:hover,
        .remove-bet-btn:hover {
          background: var(--error);
          color: white;
          border-color: var(--error);
        }
        .add-row-btn {
          width: 100%;
          padding: 0.5rem;
          margin-top: 0.5rem;
          border: 1px dashed var(--border);
          background: transparent;
          border-radius: 6px;
          cursor: pointer;
          font-size: 0.85rem;
          color: var(--text-muted);
        }
        .add-row-btn:hover {
          border-color: var(--primary);
          color: var(--primary);
        }
        .prob-total {
          margin-top: 0.5rem;
          font-size: 0.85rem;
          color: var(--text-muted);
          text-align: right;
        }
        .prob-total.error {
          color: var(--error);
          font-weight: 600;
        }
        .bet-header {
          display: flex;
          gap: 0.5rem;
          margin-bottom: 0.5rem;
          font-size: 0.75rem;
          color: var(--text-muted);
          font-weight: 600;
          min-width: max-content;
        }
        .bet-header span {
          text-align: center;
        }
        .bet-header .bet-name-header {
          width: 100px;
          text-align: left;
        }
        .bet-header .bet-return-header {
          width: 70px;
        }
        .advanced-result {
          margin-top: 1.5rem;
        }
        .advanced-result h4 {
          margin-bottom: 0.75rem;
        }
        .bet-result-row {
          display: flex;
          justify-content: space-between;
          padding: 0.75rem;
          background: var(--bg);
          border-radius: 6px;
          margin-bottom: 0.5rem;
        }
        .bet-result-name {
          font-weight: 600;
        }
        .bet-result-value {
          color: var(--primary);
          font-weight: 600;
        }
        .bet-result-value.zero {
          color: var(--text-muted);
        }
        .kelly-error {
          background: rgba(239, 68, 68, 0.1);
          border: 1px solid rgba(239, 68, 68, 0.3);
          color: var(--error);
          padding: 0.75rem 1rem;
          border-radius: 8px;
          margin-bottom: 1rem;
          text-align: center;
          font-size: 0.9rem;
          display: none;
        }
        .kelly-error.visible {
          display: block;
        }
      </style>

      <script>
        (function () {
          const LANG = "en";
          const T = {
            noBet: "Don&#39;t Bet",
            notRecommended: "Not Recommended",
            expectedValue: "Expected Value",
            highKelly: "High Kelly Ratio",
            recommendHalfQuarter: "Half/Quarter Kelly recommended",
            recommended: "Recommended",
            errorProbSum:
              LANG === "en"
                ? "Probabilities must sum to 100%"
                : "ÌôïÎ•†Ïùò Ìï©Ïù¥ 100%Í∞Ä ÎêòÏñ¥Ïïº Ìï©ÎãàÎã§",
            errorNoBets:
              LANG === "en"
                ? "Please add betting options"
                : "Î≤†ÌåÖ ÏòµÏÖòÏùÑ Ï∂îÍ∞ÄÌï¥Ï£ºÏÑ∏Ïöî",
            errorCalc: LANG === "en" ? "Calculation error" : "Í≥ÑÏÇ∞ Ï§ë Ïò§Î•ò",
            errorInput:
              LANG === "en"
                ? "Enter win probability (0-100%) and win amount"
                : "ÏäπÎ•†(0~100%)Í≥º Ïù¥Í∏∏ Îïå Î∞õÎäî Í∏àÏï°ÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî",
            betLabel: LANG === "en" ? "Bet" : "Î≤†ÌåÖ",
            outcomeLabel: LANG === "en" ? "Outcome" : "Í≤∞Í≥º",
            growthRate: LANG === "en" ? "Expected growth rate" : "Í∏∞ÎåÄ ÏÑ±Ïû•Î•†",
            optimalRatio:
              LANG === "en" ? "Optimal ratio per bet" : "Î≤†ÌåÖÎ≥Ñ ÏµúÏ†Å ÎπÑÏú®",
          };

          let currentMode = "simple";

          window.setMode = function (mode) {
            currentMode = mode;
            document.querySelectorAll(".mode-btn").forEach((btn) => {
              btn.classList.toggle("active", btn.dataset.mode === mode);
            });
            document.getElementById("simple-inputs").style.display =
              mode === "simple" ? "block" : "none";
            document.getElementById("advanced-inputs").style.display =
              mode === "advanced" ? "block" : "none";

            if (mode === "advanced") {
              initAdvancedMode();
            }
            resetResults();
          };

          function initAdvancedMode() {
            updateBetsContainer();
            updateProbTotal();
          }

          function getOutcomes() {
            const rows = document.querySelectorAll(
              "#outcomes-container .outcome-row"
            );
            return Array.from(rows).map((row) => ({
              name: row.querySelector(".outcome-name").value,
              prob:
                parseFloat(row.querySelector(".outcome-prob").value) / 100 || 0,
            }));
          }

          function updateProbTotal() {
            const outcomes = getOutcomes();
            const total = outcomes.reduce((sum, o) => sum + o.prob, 0) * 100;
            const el = document.getElementById("prob-total");
            el.textContent = total.toFixed(1);
            el.parentElement.classList.toggle(
              "error",
              Math.abs(total - 100) > 0.1
            );
          }

          window.addOutcome = function () {
            const container = document.getElementById("outcomes-container");
            const index = container.children.length;
            const row = document.createElement("div");
            row.className = "outcome-row";
            row.dataset.index = index;
            row.innerHTML =
              '<input type="text" class="outcome-name" value="' +
              T.outcomeLabel +
              (index + 1) +
              '" placeholder="' +
              T.outcomeLabel +
              '"><input type="number" class="outcome-prob" min="0" max="100" step="0.1" value="0" placeholder="' +
              (LANG === "en" ? "Prob%" : "ÌôïÎ•†%") +
              '"><button class="remove-outcome-btn" onclick="removeOutcome(this)">&times;</button>';
            container.appendChild(row);
            row.querySelector(".outcome-prob").addEventListener("input", () => {
              updateProbTotal();
              updateBetsContainer();
            });
            row
              .querySelector(".outcome-name")
              .addEventListener("input", updateBetsContainer);
            updateBetsContainer();
          };

          window.removeOutcome = function (btn) {
            const container = document.getElementById("outcomes-container");
            if (container.children.length <= 2) return;
            btn.parentElement.remove();
            updateProbTotal();
            updateBetsContainer();
          };

          function updateBetsContainer() {
            const outcomes = getOutcomes();
            const container = document.getElementById("bets-container");
            const existingBets = Array.from(
              container.querySelectorAll(".bet-row")
            ).map((row) => ({
              name: row.querySelector(".bet-name").value,
              returns: Array.from(row.querySelectorAll(".bet-return")).map(
                (input) => input.value
              ),
            }));

            let html =
              '<div class="bet-header"><span class="bet-name-header">' +
              (LANG === "en" ? "Bet Name" : "Î≤†ÌåÖÎ™Ö") +
              "</span>" +
              outcomes
                .map(
                  (o) => '<span class="bet-return-header">' + o.name + "</span>"
                )
                .join("") +
              '<span style="width:32px"></span></div>';

            const numBets = Math.max(existingBets.length, 1);
            for (let i = 0; i < numBets; i++) {
              const bet = existingBets[i] || {
                name: T.betLabel + (i + 1),
                returns: [],
              };
              html +=
                '<div class="bet-row" data-index="' +
                i +
                '"><input type="text" class="bet-name" value="' +
                bet.name +
                '" placeholder="' +
                (LANG === "en" ? "Bet name" : "Î≤†ÌåÖÎ™Ö") +
                '">' +
                outcomes
                  .map((o, j) => {
                    const defaultVal = j === 0 ? "150" : "0";
                    const val =
                      bet.returns[j] !== undefined
                        ? bet.returns[j]
                        : defaultVal;
                    return (
                      '<input type="number" class="bet-return" step="1" value="' +
                      val +
                      '" placeholder="' +
                      (LANG === "en" ? "Amount" : "Î∞õÎäîÍ∏àÏï°") +
                      '">'
                    );
                  })
                  .join("") +
                '<button class="remove-bet-btn" onclick="removeBet(this)">&times;</button></div>';
            }

            container.innerHTML = html;
          }

          window.addBet = function () {
            const outcomes = getOutcomes();
            const container = document.getElementById("bets-container");
            const index = container.querySelectorAll(".bet-row").length;
            const row = document.createElement("div");
            row.className = "bet-row";
            row.dataset.index = index;
            row.innerHTML =
              '<input type="text" class="bet-name" value="' +
              T.betLabel +
              (index + 1) +
              '" placeholder="' +
              (LANG === "en" ? "Bet name" : "Î≤†ÌåÖÎ™Ö") +
              '">' +
              outcomes
                .map(
                  (o, j) =>
                    '<input type="number" class="bet-return" step="1" value="' +
                    (j === 0 ? "150" : "0") +
                    '" placeholder="' +
                    (LANG === "en" ? "Amount" : "Î∞õÎäîÍ∏àÏï°") +
                    '">'
                )
                .join("") +
              '<button class="remove-bet-btn" onclick="removeBet(this)">&times;</button>';
            container.appendChild(row);
          };

          window.removeBet = function (btn) {
            const container = document.getElementById("bets-container");
            if (container.querySelectorAll(".bet-row").length <= 1) return;
            btn.parentElement.remove();
          };

          window.calculate = function () {
            if (currentMode === "simple") {
              calculateSimple();
            } else {
              calculateAdvanced();
            }
          };

          function calculateSimple() {
            const winProb =
              parseFloat(document.getElementById("win-prob").value) / 100;
            const winAmount = parseFloat(document.getElementById("odds").value);
            const bankroll =
              parseFloat(document.getElementById("bankroll").value) || 0;

            if (
              isNaN(winProb) ||
              isNaN(winAmount) ||
              winProb < 0 ||
              winProb > 1 ||
              winAmount <= 0
            ) {
              showError(T.errorInput);
              return;
            }
            clearError();

            const odds = (winAmount - 100) / 100;
            const loseProb = 1 - winProb;
            const kelly = (odds * winProb - loseProb) / odds;
            const kellyPercent = kelly * 100;

            const kellyPercentEl = document.getElementById("kelly-percent");
            kellyPercentEl.textContent = kellyPercent.toFixed(2) + "%";
            kellyPercentEl.className =
              "result-value " +
              (kelly > 0 ? "positive" : kelly < 0 ? "negative" : "");

            const betAmountEl = document.getElementById("bet-amount");
            if (bankroll > 0 && kelly > 0) {
              betAmountEl.textContent = formatNumber(
                Math.round(bankroll * kelly)
              );
            } else if (kelly <= 0) {
              betAmountEl.textContent = T.noBet;
              betAmountEl.className = "result-value negative";
            } else {
              betAmountEl.textContent = "-";
            }

            document.getElementById("full-kelly").textContent =
              kellyPercent.toFixed(2) + "%";
            document.getElementById("half-kelly").textContent =
              (kellyPercent / 2).toFixed(2) + "%";
            document.getElementById("quarter-kelly").textContent =
              (kellyPercent / 4).toFixed(2) + "%";

            const analysisEl = document.getElementById("analysis");
            const expectedValue = winProb * odds - loseProb;

            if (kelly <= 0) {
              analysisEl.className = "result-analysis negative";
              analysisEl.innerHTML =
                "<strong>" +
                T.notRecommended +
                "</strong><br>" +
                T.expectedValue +
                ": " +
                (expectedValue * 100).toFixed(2) +
                "% (" +
                (LANG === "en" ? "negative" : "ÏùåÏàò") +
                ")";
            } else if (kelly > 0.25) {
              analysisEl.className = "result-analysis neutral";
              analysisEl.innerHTML =
                "<strong>" +
                T.highKelly +
                "</strong><br>" +
                T.expectedValue +
                ": +" +
                (expectedValue * 100).toFixed(2) +
                "%<br>" +
                T.recommendHalfQuarter;
            } else {
              analysisEl.className = "result-analysis positive";
              analysisEl.innerHTML =
                "<strong>" +
                T.recommended +
                "</strong><br>" +
                T.expectedValue +
                ": +" +
                (expectedValue * 100).toFixed(2) +
                "%";
            }
          }

          function calculateAdvanced() {
            const outcomes = getOutcomes();
            const probSum = outcomes.reduce((sum, o) => sum + o.prob, 0);

            if (Math.abs(probSum - 1) > 0.001) {
              showError(T.errorProbSum);
              return;
            }

            const betRows = document.querySelectorAll(
              "#bets-container .bet-row"
            );
            if (betRows.length === 0) {
              showError(T.errorNoBets);
              return;
            }
            clearError();

            const bets = Array.from(betRows).map((row) => ({
              name: row.querySelector(".bet-name")?.value || T.betLabel,
              returns: Array.from(row.querySelectorAll(".bet-return")).map(
                (input) => {
                  const amount = parseFloat(input.value) || 0;
                  return (amount - 100) / 100;
                }
              ),
            }));

            const bankroll =
              parseFloat(document.getElementById("adv-bankroll").value) ||
              1000000;

            let result;
            try {
              result = optimizeKelly(outcomes, bets);
            } catch (e) {
              showError(T.errorCalc + ": " + e.message);
              return;
            }

            const kellyPercentEl = document.getElementById("kelly-percent");
            const totalBet = result.fractions.reduce(
              (sum, f) => sum + Math.max(0, f),
              0
            );
            kellyPercentEl.textContent = (totalBet * 100).toFixed(2) + "%";
            kellyPercentEl.className =
              "result-value " + (totalBet > 0 ? "positive" : "negative");

            const betAmountEl = document.getElementById("bet-amount");
            betAmountEl.textContent = formatNumber(
              Math.round(bankroll * totalBet)
            );

            document.getElementById("full-kelly").textContent = "-";
            document.getElementById("half-kelly").textContent = "-";
            document.getElementById("quarter-kelly").textContent = "-";

            const analysisEl = document.getElementById("analysis");
            let html =
              '<div class="advanced-result"><h4>' + T.optimalRatio + "</h4>";

            bets.forEach((bet, i) => {
              const fraction = result.fractions[i];
              const percent = (fraction * 100).toFixed(2);
              const amount = Math.round(bankroll * Math.max(0, fraction));
              const isZero = fraction <= 0.001;
              html +=
                '<div class="bet-result-row"><span class="bet-result-name">' +
                bet.name +
                '</span><span class="bet-result-value ' +
                (isZero ? "zero" : "") +
                '">' +
                (isZero ? "0%" : percent + "%") +
                " (" +
                formatNumber(amount) +
                (LANG === "en" ? "" : "Ïõê") +
                ")</span></div>";
            });

            html +=
              '<div style="margin-top:1rem;font-size:0.85rem;color:var(--text-muted)">' +
              T.growthRate +
              ": " +
              (result.expectedGrowth * 100).toFixed(4) +
              "%/" +
              (LANG === "en" ? "bet" : "Ìöå") +
              "</div></div>";

            analysisEl.className =
              "result-analysis " +
              (result.expectedGrowth > 0 ? "positive" : "negative");
            analysisEl.innerHTML = html;
          }

          function optimizeKelly(outcomes, bets) {
            const n = bets.length;
            let fractions = new Array(n).fill(0.01);
            const learningRate = 0.01;
            const iterations = 1000;

            for (let iter = 0; iter < iterations; iter++) {
              const gradient = computeGradient(outcomes, bets, fractions);

              for (let i = 0; i < n; i++) {
                fractions[i] += learningRate * gradient[i];
                fractions[i] = Math.max(0, fractions[i]);
              }

              const sum = fractions.reduce((a, b) => a + b, 0);
              if (sum > 0.99) {
                fractions = fractions.map((f) => (f * 0.99) / sum);
              }
            }

            const expectedGrowth = computeExpectedLogGrowth(
              outcomes,
              bets,
              fractions
            );

            return { fractions, expectedGrowth };
          }

          function computeExpectedLogGrowth(outcomes, bets, fractions) {
            let expected = 0;

            for (let i = 0; i < outcomes.length; i++) {
              let wealth = 1;
              for (let j = 0; j < bets.length; j++) {
                wealth += fractions[j] * bets[j].returns[i];
              }
              if (wealth > 0) {
                expected += outcomes[i].prob * Math.log(wealth);
              } else {
                expected += outcomes[i].prob * Math.log(0.0001);
              }
            }

            return expected;
          }

          function computeGradient(outcomes, bets, fractions) {
            const n = bets.length;
            const gradient = new Array(n).fill(0);

            for (let i = 0; i < outcomes.length; i++) {
              let wealth = 1;
              for (let j = 0; j < n; j++) {
                wealth += fractions[j] * bets[j].returns[i];
              }

              if (wealth > 0.0001) {
                for (let j = 0; j < n; j++) {
                  gradient[j] +=
                    (outcomes[i].prob * bets[j].returns[i]) / wealth;
                }
              }
            }

            return gradient;
          }

          function formatNumber(num) {
            return num.toLocaleString(LANG === "en" ? "en-US" : "ko-KR");
          }

          function showError(msg) {
            const el = document.getElementById("error-msg");
            el.textContent = msg;
            el.classList.add("visible");
          }

          function clearError() {
            const el = document.getElementById("error-msg");
            el.textContent = "";
            el.classList.remove("visible");
          }

          function resetResults() {
            document.getElementById("kelly-percent").textContent = "-";
            document.getElementById("kelly-percent").className = "result-value";
            document.getElementById("bet-amount").textContent = "-";
            document.getElementById("bet-amount").className = "result-value";
            document.getElementById("full-kelly").textContent = "-";
            document.getElementById("half-kelly").textContent = "-";
            document.getElementById("quarter-kelly").textContent = "-";
            document.getElementById("analysis").innerHTML = "";
            document.getElementById("analysis").className = "result-analysis";
            clearError();
          }

          window.resetForm = function () {
            if (currentMode === "simple") {
              document.getElementById("win-prob").value = "60";
              document.getElementById("odds").value = "200";
              document.getElementById("bankroll").value = "";
            } else {
              document.getElementById("adv-bankroll").value = "1000000";
              document.getElementById("outcomes-container").innerHTML =
                '<div class="outcome-row" data-index="0"><input type="text" class="outcome-name" value="' +
                (LANG === "en" ? "Win" : "ÏäπÎ¶¨") +
                '" placeholder="' +
                T.outcomeLabel +
                '"><input type="number" class="outcome-prob" min="0" max="100" step="0.1" value="40" placeholder="' +
                (LANG === "en" ? "Prob%" : "ÌôïÎ•†%") +
                '"><button class="remove-outcome-btn" onclick="removeOutcome(this)">&times;</button></div><div class="outcome-row" data-index="1"><input type="text" class="outcome-name" value="' +
                (LANG === "en" ? "Draw" : "Î¨¥ÏäπÎ∂Ä") +
                '" placeholder="' +
                T.outcomeLabel +
                '"><input type="number" class="outcome-prob" min="0" max="100" step="0.1" value="30" placeholder="' +
                (LANG === "en" ? "Prob%" : "ÌôïÎ•†%") +
                '"><button class="remove-outcome-btn" onclick="removeOutcome(this)">&times;</button></div><div class="outcome-row" data-index="2"><input type="text" class="outcome-name" value="' +
                (LANG === "en" ? "Lose" : "Ìå®Î∞∞") +
                '" placeholder="' +
                T.outcomeLabel +
                '"><input type="number" class="outcome-prob" min="0" max="100" step="0.1" value="30" placeholder="' +
                (LANG === "en" ? "Prob%" : "ÌôïÎ•†%") +
                '"><button class="remove-outcome-btn" onclick="removeOutcome(this)">&times;</button></div>';
              initAdvancedMode();
            }
            resetResults();
          };

          document.addEventListener("DOMContentLoaded", () => {
            ["win-prob", "odds", "bankroll"].forEach((id) => {
              document.getElementById(id).addEventListener("input", calculate);
            });

            document
              .querySelectorAll("#outcomes-container .outcome-prob")
              .forEach((input) => {
                input.addEventListener("input", () => {
                  updateProbTotal();
                  updateBetsContainer();
                });
              });
            document
              .querySelectorAll("#outcomes-container .outcome-name")
              .forEach((input) => {
                input.addEventListener("input", updateBetsContainer);
              });

            calculate();
          });
        })();
      </script>
    </main>

    <footer>
      <div class="footer-content">
        <p>&copy; 2025 tools.pllip.com</p>
        <div class="lang-switcher">
          <a href="/kelly/" class="lang-btn">ÌïúÍµ≠Ïñ¥</a>
          <a href="/en/kelly/" class="lang-btn active">English</a>
        </div>
      </div>
    </footer>

    <script>
      (function () {
        // Nav scroll arrows
        const menu = document.getElementById("nav-menu");
        const prevBtn = document.querySelector(".nav-prev");
        const nextBtn = document.querySelector(".nav-next");

        function updateArrows() {
          const needsScroll = menu.scrollWidth > menu.clientWidth;
          const atStart = menu.scrollLeft <= 0;
          const atEnd =
            menu.scrollLeft >= menu.scrollWidth - menu.clientWidth - 1;

          if (needsScroll) {
            prevBtn.classList.add("visible");
            nextBtn.classList.add("visible");
            prevBtn.classList.toggle("hidden", atStart);
            nextBtn.classList.toggle("hidden", atEnd);
          } else {
            prevBtn.classList.remove("visible");
            nextBtn.classList.remove("visible");
          }
        }

        prevBtn.addEventListener("click", () =>
          menu.scrollBy({ left: -150, behavior: "smooth" })
        );
        nextBtn.addEventListener("click", () =>
          menu.scrollBy({ left: 150, behavior: "smooth" })
        );
        menu.addEventListener("scroll", updateArrows);
        window.addEventListener("resize", updateArrows);

        // Scroll to active menu item on load
        const activeItem = menu.querySelector("a.active");
        if (activeItem) {
          const li = activeItem.parentElement;
          const menuRect = menu.getBoundingClientRect();
          const liRect = li.getBoundingClientRect();
          const scrollLeft =
            li.offsetLeft - menuRect.width / 2 + liRect.width / 2;
          menu.scrollLeft = Math.max(0, scrollLeft);
        }
        updateArrows();

        // Header search dropdown
        const searchBtn = document.getElementById("search-btn");
        const dropdown = document.getElementById("search-dropdown");
        const searchInput = document.getElementById("header-search");
        const results = document.getElementById("search-results");
        const items = results.querySelectorAll("li");

        searchBtn.addEventListener("click", (e) => {
          e.stopPropagation();
          dropdown.classList.toggle("open");
          if (dropdown.classList.contains("open")) {
            searchInput.focus();
          }
        });

        document.addEventListener("click", (e) => {
          if (!dropdown.contains(e.target) && e.target !== searchBtn) {
            dropdown.classList.remove("open");
          }
        });

        searchInput.addEventListener("input", () => {
          const q = searchInput.value.toLowerCase().trim();
          let visible = 0;
          items.forEach((li) => {
            const a = li.querySelector("a");
            const text = a.textContent.toLowerCase();
            const keywords = (a.dataset.keywords || "").toLowerCase();
            const match = !q || text.includes(q) || keywords.includes(q);
            li.classList.toggle("hidden", !match);
            if (match) visible++;
          });
        });

        // Keyboard shortcut: Cmd/Ctrl + K
        document.addEventListener("keydown", (e) => {
          if ((e.metaKey || e.ctrlKey) && e.key === "k") {
            e.preventDefault();
            dropdown.classList.add("open");
            searchInput.focus();
          }
          if (e.key === "Escape") {
            dropdown.classList.remove("open");
          }
        });
      })();
    </script>
    <script
      defer
      src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015"
      integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ=="
      data-cf-beacon='{"version":"2024.11.0","token":"a47e96a534854c899db066813b9421c4","r":1,"server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}'
      crossorigin="anonymous"
    ></script>
  </body>
</html>
