<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Google Analytics -->
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=G-Y4NESGBMLL"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());
      gtag("config", "G-Y4NESGBMLL");
    </script>

    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>Sudoku - MyTools</title>
    <meta
      name="description"
      content="Online Sudoku game. Train your brain with various difficulty levels."
    />
    <meta
      name="keywords"
      content="sudoku, puzzle, number game, brain game, logic puzzle"
    />

    <!-- Open Graph / SNS Í≥µÏú† -->
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Sudoku" />
    <meta
      property="og:description"
      content="Online Sudoku game. Train your brain with various difficulty levels."
    />
    <meta property="og:url" content="https://tools.pllip.com/en/sudoku/" />
    <meta property="og:site_name" content="MyTools" />
    <meta property="og:locale" content="en_US" />

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Sudoku" />
    <meta
      name="twitter:description"
      content="Online Sudoku game. Train your brain with various difficulty levels."
    />

    <!-- Canonical URL -->
    <link rel="canonical" href="https://tools.pllip.com/en/sudoku/" />

    <!-- Alternate language links -->

    <link
      rel="alternate"
      hreflang="ko"
      href="https://tools.pllip.com/sudoku/"
    />
    <link
      rel="alternate"
      hreflang="en"
      href="https://tools.pllip.com/en/sudoku/"
    />
    <link
      rel="alternate"
      hreflang="x-default"
      href="https://tools.pllip.com/sudoku/"
    />

    <!-- Íµ¨Ï°∞ÌôîÎêú Îç∞Ïù¥ÌÑ∞ -->
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "WebSite",
        "name": "tools.pllip.com",
        "alternateName": "Online Tools",
        "url": "https://tools.pllip.com/en/",
        "description": "Free online tools collection. IP address lookup, QR code generator, JSON/XML formatter, Markdown viewer, Base64 converter, and regex tester.",
        "inLanguage": "en",
        "potentialAction": {
          "@type": "SearchAction",
          "target": {
            "@type": "EntryPoint",
            "urlTemplate": "https://tools.pllip.com/en/?q={search_term_string}"
          },
          "query-input": "required name=search_term_string"
        }
      }
    </script>

    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "Sudoku",
        "description": "Play sudoku puzzles or get solving hints",
        "url": "https://tools.pllip.com/en/sudoku/",
        "applicationCategory": "UtilitiesApplication",
        "operatingSystem": "Any",
        "inLanguage": "en",
        "offers": {
          "@type": "Offer",
          "price": "0",
          "priceCurrency": "USD"
        },
        "isPartOf": {
          "@type": "WebSite",
          "name": "tools.pllip.com",
          "url": "https://tools.pllip.com"
        }
      }
    </script>

    <link rel="stylesheet" href="/css/style.css?v=80f21ced" />
  </head>
  <body>
    <header>
      <nav>
        <a href="/en/" class="logo"
          ><span class="logo-full">tools.pllip.com</span
          ><span class="logo-short">tools</span></a
        >
        <div class="nav-wrapper">
          <button class="nav-arrow nav-prev" aria-label="Previous">
            &#8249;
          </button>
          <ul id="nav-menu">
            <li><a href="/en/ip/">IP Check</a></li>

            <li><a href="/en/qr/">QR Code</a></li>

            <li><a href="/en/json/">JSON</a></li>

            <li><a href="/en/xml/">XML</a></li>

            <li><a href="/en/md/">Markdown</a></li>

            <li><a href="/en/base64/">Base64</a></li>

            <li><a href="/en/regex/">Regex</a></li>

            <li><a href="/en/uuid/">UUID</a></li>

            <li><a href="/en/hash/">Hash</a></li>

            <li><a href="/en/ladder/">Ladder</a></li>

            <li><a href="/en/kelly/">Kelly</a></li>

            <li><a href="/en/sudoku/" class="active">Sudoku</a></li>

            <li><a href="/en/loan/">Loan</a></li>
          </ul>
          <button class="nav-arrow nav-next" aria-label="Next">&#8250;</button>
        </div>
        <div class="nav-search">
          <button class="search-btn" id="search-btn" aria-label="Search">
            <svg
              width="18"
              height="18"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <circle cx="11" cy="11" r="8" />
              <path d="m21 21-4.35-4.35" />
            </svg>
          </button>
          <div class="search-dropdown" id="search-dropdown">
            <input
              type="text"
              id="header-search"
              placeholder="Search tools..."
              autocomplete="off"
            />
            <ul id="search-results">
              <li>
                <a
                  href="/en/ip/"
                  data-keywords="ip address ipv4 ipv6 myip whatismyip location lookup IP Address Lookup IP Check"
                  >üåê IP Address Lookup</a
                >
              </li>

              <li>
                <a
                  href="/en/qr/"
                  data-keywords="qr code barcode wifi vcard generator create QR Code Generator QR Code"
                  >üì± QR Code Generator</a
                >
              </li>

              <li>
                <a
                  href="/en/json/"
                  data-keywords="json formatter beautify minify validate parser JSON Formatter JSON"
                  >{ } JSON Formatter</a
                >
              </li>

              <li>
                <a
                  href="/en/xml/"
                  data-keywords="xml formatter beautify html xhtml convert json XML Formatter XML"
                  >&lt;/&gt; XML Formatter</a
                >
              </li>

              <li>
                <a
                  href="/en/md/"
                  data-keywords="markdown md preview editor github readme Markdown Viewer Markdown"
                  >M‚Üì Markdown Viewer</a
                >
              </li>

              <li>
                <a
                  href="/en/base64/"
                  data-keywords="base64 encode decode encoder decoder converter Base64 Converter Base64"
                  >B64 Base64 Converter</a
                >
              </li>

              <li>
                <a
                  href="/en/regex/"
                  data-keywords="regex regexp regular expression pattern tester Regex Tester Regex"
                  >.* Regex Tester</a
                >
              </li>

              <li>
                <a
                  href="/en/uuid/"
                  data-keywords="uuid guid unique id generator random UUID Generator UUID"
                  ># UUID Generator</a
                >
              </li>

              <li>
                <a
                  href="/en/hash/"
                  data-keywords="hash md5 sha1 sha256 sha512 checksum generator Hash Generator Hash"
                  >## Hash Generator</a
                >
              </li>

              <li>
                <a
                  href="/en/ladder/"
                  data-keywords="ladder game random picker lottery selection Ladder Game Ladder"
                  >ü™ú Ladder Game</a
                >
              </li>

              <li>
                <a
                  href="/en/kelly/"
                  data-keywords="kelly criterion betting investment ratio bankroll odds Kelly Criterion Calculator Kelly"
                  >üìä Kelly Criterion Calculator</a
                >
              </li>

              <li>
                <a
                  href="/en/sudoku/"
                  data-keywords="sudoku puzzle number game brain logic solver hints Sudoku Sudoku"
                  >9 Sudoku</a
                >
              </li>

              <li>
                <a
                  href="/en/loan/"
                  data-keywords="loan calculator repayment mortgage amortization interest rate debt payoff strategy Loan Repayment Calculator Loan"
                  >üí∞ Loan Repayment Calculator</a
                >
              </li>
            </ul>
          </div>
        </div>
      </nav>
    </header>

    <main>
      <div class="sudoku-container">
        <div class="sudoku-mode-toggle">
          <button
            class="mode-btn active"
            data-mode="game"
            onclick="setMode('game')"
          >
            Game
          </button>
          <button class="mode-btn" data-mode="solve" onclick="setMode('solve')">
            Solve
          </button>
        </div>

        <div class="sudoku-controls" id="game-controls">
          <div class="difficulty-select">
            <label for="difficulty">Difficulty:</label>
            <select id="difficulty">
              <option value="easy">Easy</option>
              <option value="medium" selected>Medium</option>
              <option value="hard">Hard</option>
              <option value="expert">Expert</option>
            </select>
          </div>
          <button class="btn btn-primary" onclick="newGame()">New Game</button>
        </div>

        <div class="sudoku-controls" id="solve-controls" style="display: none">
          <button
            class="btn btn-primary"
            id="solve-start-btn"
            onclick="startSolving()"
          >
            Start Solving
          </button>
          <button class="btn btn-secondary" onclick="clearBoard()">
            Clear
          </button>
        </div>

        <div class="sudoku-info">
          <span class="timer" id="timer">00:00</span>
          <span class="solve-status" id="solve-status"></span>
        </div>

        <div class="sudoku-board" id="board"></div>

        <div class="sudoku-numpad">
          <button class="numpad-btn" onclick="selectNumber(1)">1</button>
          <button class="numpad-btn" onclick="selectNumber(2)">2</button>
          <button class="numpad-btn" onclick="selectNumber(3)">3</button>
          <button class="numpad-btn" onclick="selectNumber(4)">4</button>
          <button class="numpad-btn" onclick="selectNumber(5)">5</button>
          <button class="numpad-btn" onclick="selectNumber(6)">6</button>
          <button class="numpad-btn" onclick="selectNumber(7)">7</button>
          <button class="numpad-btn" onclick="selectNumber(8)">8</button>
          <button class="numpad-btn" onclick="selectNumber(9)">9</button>
          <button class="numpad-btn erase-btn" onclick="eraseCell()">√ó</button>
        </div>

        <div class="sudoku-actions" id="game-actions">
          <button class="btn btn-secondary" onclick="undoMove()">Undo</button>
          <button class="btn btn-secondary" onclick="getHint()">Hint</button>
        </div>

        <div class="sudoku-actions" id="solve-actions" style="display: none">
          <button class="btn btn-secondary" onclick="undoMove()">Undo</button>
          <button class="btn btn-secondary" onclick="solveNext()">
            Next Hint
          </button>
          <button class="btn btn-secondary" onclick="solveAll()">
            Solve All
          </button>
        </div>

        <div class="sudoku-message" id="message"></div>
      </div>

      <style>
        .sudoku-container {
          max-width: 450px;
          margin: 0 auto;
        }
        .sudoku-mode-toggle {
          display: flex;
          justify-content: center;
          gap: 0.5rem;
          margin-bottom: 1rem;
        }
        .mode-btn {
          padding: 0.5rem 1.5rem;
          border: 1px solid var(--border);
          background: var(--card-bg);
          border-radius: 8px;
          cursor: pointer;
          font-size: 0.9rem;
          transition: all 0.2s;
        }
        .mode-btn:hover {
          border-color: var(--primary);
        }
        .mode-btn.active {
          background: var(--primary);
          color: white;
          border-color: var(--primary);
        }
        .sudoku-controls {
          display: flex;
          gap: 1rem;
          justify-content: center;
          align-items: center;
          margin-bottom: 1rem;
          flex-wrap: wrap;
        }
        .difficulty-select {
          display: flex;
          align-items: center;
          gap: 0.5rem;
        }
        .difficulty-select select {
          padding: 0.5rem 1rem;
          border: 1px solid var(--border);
          border-radius: 8px;
          font-size: 1rem;
          background: var(--card-bg);
        }
        .sudoku-info {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: 1rem;
          padding: 0.5rem 1rem;
          background: var(--card-bg);
          border-radius: 8px;
          font-size: 0.9rem;
        }
        .timer {
          font-family: monospace;
          font-size: 1.1rem;
          font-weight: 600;
        }
        .solve-status {
          font-size: 0.85rem;
          color: var(--text-muted);
        }
        .solve-status.ready {
          color: var(--success);
        }
        .solve-status.invalid {
          color: var(--error);
        }
        .sudoku-board {
          display: grid;
          grid-template-columns: repeat(9, 1fr);
          gap: 1px;
          background: var(--border);
          border: 2px solid var(--text);
          border-radius: 4px;
          overflow: hidden;
          aspect-ratio: 1;
          max-width: 100%;
          margin: 0 auto;
        }
        .sudoku-cell {
          aspect-ratio: 1;
          display: flex;
          align-items: center;
          justify-content: center;
          font-size: 1.5rem;
          font-weight: 600;
          background: var(--card-bg);
          cursor: pointer;
          transition: background 0.15s;
          position: relative;
        }
        .sudoku-cell:hover {
          background: var(--bg);
        }
        .sudoku-cell.selected {
          background: rgba(59, 130, 246, 0.3);
        }
        .sudoku-cell.same-number {
          background: rgba(59, 130, 246, 0.15);
        }
        .sudoku-cell.same-row-col-box {
          background: rgba(59, 130, 246, 0.08);
        }
        .sudoku-cell.fixed {
          color: var(--text);
          cursor: default;
        }
        .sudoku-cell.user-input {
          color: var(--primary);
        }
        .sudoku-cell.error {
          color: var(--error);
        }
        .sudoku-cell.hint {
          color: var(--success);
        }
        .sudoku-cell:nth-child(3n) {
          border-right: 2px solid var(--text);
        }
        .sudoku-cell:nth-child(9n) {
          border-right: none;
        }
        .sudoku-cell:nth-child(n + 19):nth-child(-n + 27),
        .sudoku-cell:nth-child(n + 46):nth-child(-n + 54) {
          border-bottom: 2px solid var(--text);
        }
        .sudoku-numpad {
          display: grid;
          grid-template-columns: repeat(5, 1fr);
          gap: 0.5rem;
          margin: 1rem 0;
        }
        .numpad-btn {
          aspect-ratio: 1;
          font-size: 1.25rem;
          font-weight: 600;
          border: 1px solid var(--border);
          background: var(--card-bg);
          border-radius: 8px;
          cursor: pointer;
          transition: all 0.15s;
        }
        .numpad-btn:hover {
          background: var(--primary);
          color: white;
          border-color: var(--primary);
        }
        .numpad-btn.selected {
          background: var(--primary);
          color: white;
          border-color: var(--primary);
        }
        .numpad-btn.completed {
          opacity: 0.4;
          cursor: default;
        }
        .numpad-btn.erase-btn {
          background: var(--bg);
        }
        .sudoku-actions {
          display: flex;
          gap: 0.5rem;
          justify-content: center;
          flex-wrap: wrap;
        }
        .sudoku-actions .btn {
          flex: 1;
          min-width: 80px;
        }
        .sudoku-message {
          margin-top: 1rem;
          padding: 1rem;
          border-radius: 8px;
          text-align: center;
          display: none;
        }
        .sudoku-message.visible {
          display: block;
        }
        .sudoku-message.success {
          background: rgba(34, 197, 94, 0.1);
          border: 1px solid rgba(34, 197, 94, 0.3);
          color: var(--success);
        }
        .sudoku-message.error {
          background: rgba(239, 68, 68, 0.1);
          border: 1px solid rgba(239, 68, 68, 0.3);
          color: var(--error);
        }
        @media (max-width: 400px) {
          .sudoku-cell {
            font-size: 1.2rem;
          }
          .numpad-btn {
            font-size: 1rem;
          }
        }
      </style>

      <script>
        (function () {
          const T = {
            startSolving: "Start Solving",
            reEnter: "Re-enter",
            solvable: "Solvable",
            invalid: "Invalid",
            unsolvable: "Unsolvable",
            invalidPuzzle:
              "Invalid puzzle. Please check for duplicate numbers.",
            unsolvablePuzzle: "This puzzle cannot be solved.",
            wrongNumbers: " wrong numbers found. Please correct them.",
            congratulations: "Congratulations!",
            completedIn: "Completed in ",
          };
          const LANG = "en";

          let board = [];
          let solution = [];
          let fixed = [];
          let selectedCell = null;
          let selectedNumber = null;
          let timerInterval = null;
          let seconds = 0;
          let moveHistory = [];
          let solved = false;
          let currentMode = "game";
          let solveStarted = false;

          const DIFFICULTY = { easy: 38, medium: 30, hard: 25, expert: 20 };

          function init() {
            newGame();
          }

          window.setMode = function (mode) {
            currentMode = mode;
            solveStarted = false;

            document.querySelectorAll(".mode-btn").forEach((btn) => {
              btn.classList.toggle("active", btn.dataset.mode === mode);
            });

            document.getElementById("game-controls").style.display =
              mode === "game" ? "flex" : "none";
            document.getElementById("solve-controls").style.display =
              mode === "solve" ? "flex" : "none";
            document.getElementById("game-actions").style.display =
              mode === "game" ? "flex" : "none";
            document.getElementById("solve-actions").style.display =
              mode === "solve" ? "flex" : "none";

            document.getElementById("solve-start-btn").textContent =
              T.startSolving;
            document.getElementById("solve-status").textContent = "";
            document.getElementById("solve-status").className = "solve-status";

            if (mode === "game") {
              newGame();
            } else {
              initSolveMode();
            }
          };

          function initSolveMode() {
            stopTimer();
            seconds = 0;
            updateTimer();

            board = Array(9)
              .fill(null)
              .map(() => Array(9).fill(0));
            solution = [];
            fixed = Array(9)
              .fill(null)
              .map(() => Array(9).fill(false));
            selectedCell = null;
            selectedNumber = null;
            moveHistory = [];
            solved = false;

            renderBoard();
            hideMessage();
            updateNumpadCompletion();
          }

          window.newGame = function () {
            const difficulty = document.getElementById("difficulty").value;
            const cellsToShow = DIFFICULTY[difficulty];

            seconds = 0;
            selectedCell = null;
            selectedNumber = null;
            moveHistory = [];
            solved = false;

            hideMessage();

            solution = generateSolution();
            const puzzle = createPuzzle(solution, cellsToShow);
            board = puzzle.map((row) => row.slice());
            fixed = puzzle.map((row) => row.map((v) => v !== 0));

            renderBoard();
            startTimer();
            updateNumpadCompletion();
          };

          function generateSolution() {
            const grid = Array(9)
              .fill(null)
              .map(() => Array(9).fill(0));
            fillGrid(grid);
            return grid;
          }

          function fillGrid(grid) {
            const numbers = [1, 2, 3, 4, 5, 6, 7, 8, 9];

            for (let row = 0; row < 9; row++) {
              for (let col = 0; col < 9; col++) {
                if (grid[row][col] === 0) {
                  shuffle(numbers);
                  for (const num of numbers) {
                    if (isValid(grid, row, col, num)) {
                      grid[row][col] = num;
                      if (fillGrid(grid)) return true;
                      grid[row][col] = 0;
                    }
                  }
                  return false;
                }
              }
            }
            return true;
          }

          function shuffle(array) {
            for (let i = array.length - 1; i > 0; i--) {
              const j = Math.floor(Math.random() * (i + 1));
              [array[i], array[j]] = [array[j], array[i]];
            }
          }

          function isValid(grid, row, col, num) {
            if (grid[row].includes(num)) return false;
            for (let r = 0; r < 9; r++) {
              if (grid[r][col] === num) return false;
            }
            const boxRow = Math.floor(row / 3) * 3;
            const boxCol = Math.floor(col / 3) * 3;
            for (let r = boxRow; r < boxRow + 3; r++) {
              for (let c = boxCol; c < boxCol + 3; c++) {
                if (grid[r][c] === num) return false;
              }
            }
            return true;
          }

          function createPuzzle(solution, cellsToShow) {
            const puzzle = solution.map((row) => row.slice());
            const positions = [];
            for (let r = 0; r < 9; r++) {
              for (let c = 0; c < 9; c++) {
                positions.push([r, c]);
              }
            }
            shuffle(positions);
            const cellsToRemove = 81 - cellsToShow;
            for (let i = 0; i < cellsToRemove; i++) {
              const [r, c] = positions[i];
              puzzle[r][c] = 0;
            }
            return puzzle;
          }

          function renderBoard() {
            const boardEl = document.getElementById("board");
            boardEl.innerHTML = "";

            for (let r = 0; r < 9; r++) {
              for (let c = 0; c < 9; c++) {
                const cell = document.createElement("div");
                cell.className = "sudoku-cell";
                cell.dataset.row = r;
                cell.dataset.col = c;

                const value = board[r][c];
                if (value !== 0) {
                  cell.textContent = value;
                  if (fixed[r][c]) {
                    cell.classList.add("fixed");
                  } else {
                    cell.classList.add("user-input");
                  }
                }

                cell.addEventListener("click", () => selectCell(r, c));
                boardEl.appendChild(cell);
              }
            }
          }

          function selectCell(row, col) {
            if (solved) return;

            const cells = document.querySelectorAll(".sudoku-cell");
            cells.forEach((c) => {
              c.classList.remove("selected", "same-number", "same-row-col-box");
            });

            const index = row * 9 + col;
            const cell = cells[index];

            if (fixed[row][col]) {
              selectedCell = null;
              highlightRelated(row, col, board[row][col]);
              return;
            }

            selectedCell = { row, col };
            cell.classList.add("selected");
            highlightRelated(row, col, board[row][col]);

            if (selectedNumber !== null) {
              placeNumber(selectedNumber);
            }
          }

          function highlightRelated(row, col, num) {
            const cells = document.querySelectorAll(".sudoku-cell");

            cells.forEach((cell) => {
              const r = parseInt(cell.dataset.row);
              const c = parseInt(cell.dataset.col);

              const sameRow = r === row;
              const sameCol = c === col;
              const sameBox =
                Math.floor(r / 3) === Math.floor(row / 3) &&
                Math.floor(c / 3) === Math.floor(col / 3);

              if (
                (sameRow || sameCol || sameBox) &&
                !(r === row && c === col)
              ) {
                cell.classList.add("same-row-col-box");
              }

              if (
                num !== 0 &&
                board[r][c] === num &&
                !(r === row && c === col)
              ) {
                cell.classList.add("same-number");
              }
            });
          }

          window.selectNumber = function (num) {
            if (solved) return;

            const numpadBtns = document.querySelectorAll(
              ".numpad-btn:not(.erase-btn)"
            );
            numpadBtns.forEach((btn) => btn.classList.remove("selected"));

            if (selectedNumber === num) {
              selectedNumber = null;
            } else {
              selectedNumber = num;
              numpadBtns[num - 1].classList.add("selected");
              if (selectedCell) {
                placeNumber(num);
              }
            }
          };

          function placeNumber(num) {
            if (!selectedCell || solved) return;
            const { row, col } = selectedCell;
            if (fixed[row][col]) return;
            const prevValue = board[row][col];
            if (prevValue === num) return;

            clearErrors();
            moveHistory.push({ row, col, prevValue, newValue: num });
            board[row][col] = num;

            const cell = document.querySelector(
              '[data-row="' + row + '"][data-col="' + col + '"]'
            );
            cell.textContent = num;
            cell.classList.remove("hint");
            cell.classList.add("user-input");

            updateNumpadCompletion();
            highlightRelated(row, col, num);

            selectedNumber = null;
            document
              .querySelectorAll(".numpad-btn")
              .forEach((btn) => btn.classList.remove("selected"));

            checkBoardFull();
          }

          window.eraseCell = function () {
            if (!selectedCell || solved) return;
            const { row, col } = selectedCell;
            if (fixed[row][col]) return;
            const prevValue = board[row][col];
            if (prevValue === 0) return;

            clearErrors();
            moveHistory.push({ row, col, prevValue, newValue: 0 });
            board[row][col] = 0;

            const cell = document.querySelector(
              '[data-row="' + row + '"][data-col="' + col + '"]'
            );
            cell.textContent = "";
            cell.classList.remove("error", "user-input", "hint");

            updateNumpadCompletion();
          };

          window.undoMove = function () {
            if (moveHistory.length === 0 || solved) return;

            const lastMove = moveHistory.pop();
            const { row, col, prevValue } = lastMove;

            board[row][col] = prevValue;

            const cell = document.querySelector(
              '[data-row="' + row + '"][data-col="' + col + '"]'
            );
            cell.textContent = prevValue === 0 ? "" : prevValue;
            cell.classList.remove("error", "user-input", "hint");

            if (prevValue !== 0) {
              cell.classList.add("user-input");
            }

            updateNumpadCompletion();

            if (
              selectedCell &&
              selectedCell.row === row &&
              selectedCell.col === col
            ) {
              highlightRelated(row, col, prevValue);
            }
          };

          window.getHint = function () {
            if (solved) return;

            const candidates = [];
            for (let r = 0; r < 9; r++) {
              for (let c = 0; c < 9; c++) {
                if (!fixed[r][c] && board[r][c] !== solution[r][c]) {
                  candidates.push([r, c]);
                }
              }
            }

            if (candidates.length === 0) return;

            const [row, col] =
              candidates[Math.floor(Math.random() * candidates.length)];
            const num = solution[row][col];

            const prevValue = board[row][col];
            moveHistory.push({ row, col, prevValue, newValue: num });

            board[row][col] = num;

            const cell = document.querySelector(
              '[data-row="' + row + '"][data-col="' + col + '"]'
            );
            cell.textContent = num;
            cell.classList.remove("error", "user-input");
            cell.classList.add("hint");

            updateNumpadCompletion();

            if (isSolved()) {
              endGame();
            }
          };

          function isSolved() {
            for (let r = 0; r < 9; r++) {
              for (let c = 0; c < 9; c++) {
                if (board[r][c] !== solution[r][c]) return false;
              }
            }
            return true;
          }

          function isBoardFull() {
            for (let r = 0; r < 9; r++) {
              for (let c = 0; c < 9; c++) {
                if (board[r][c] === 0) return false;
              }
            }
            return true;
          }

          function checkBoardFull() {
            if (!isBoardFull()) return;

            if (isSolved()) {
              endGame();
            } else {
              const cells = document.querySelectorAll(".sudoku-cell");
              let errorCount = 0;
              cells.forEach((cell) => {
                const r = parseInt(cell.dataset.row);
                const c = parseInt(cell.dataset.col);
                if (board[r][c] !== solution[r][c]) {
                  cell.classList.add("error");
                  errorCount++;
                }
              });
              showMessage(errorCount + T.wrongNumbers, "error");
            }
          }

          function clearErrors() {
            document.querySelectorAll(".sudoku-cell.error").forEach((cell) => {
              cell.classList.remove("error");
            });
            hideMessage();
          }

          function endGame() {
            solved = true;
            stopTimer();
            const msg =
              LANG === "en"
                ? T.congratulations +
                  " " +
                  T.completedIn +
                  formatTime(seconds) +
                  "!"
                : T.congratulations + " " + formatTime(seconds) + T.completedIn;
            showMessage(msg, "success");
          }

          window.clearBoard = function () {
            initSolveMode();
          };

          window.startSolving = function () {
            if (solveStarted) {
              solveStarted = false;
              fixed = Array(9)
                .fill(null)
                .map(() => Array(9).fill(false));
              solution = [];
              document.getElementById("solve-start-btn").textContent =
                T.startSolving;
              document.getElementById("solve-status").textContent = "";
              document.getElementById("solve-status").className =
                "solve-status";
              renderBoard();
              return;
            }

            if (!validatePuzzle()) {
              showMessage(T.invalidPuzzle, "error");
              document.getElementById("solve-status").textContent = T.invalid;
              document.getElementById("solve-status").className =
                "solve-status invalid";
              return;
            }

            const boardCopy = board.map((row) => row.slice());
            if (!solveSudoku(boardCopy)) {
              showMessage(T.unsolvablePuzzle, "error");
              document.getElementById("solve-status").textContent =
                T.unsolvable;
              document.getElementById("solve-status").className =
                "solve-status invalid";
              return;
            }

            for (let r = 0; r < 9; r++) {
              for (let c = 0; c < 9; c++) {
                if (board[r][c] !== 0) {
                  fixed[r][c] = true;
                }
              }
            }

            solution = boardCopy;
            solveStarted = true;
            moveHistory = [];

            document.getElementById("solve-start-btn").textContent = T.reEnter;
            document.getElementById("solve-status").textContent = T.solvable;
            document.getElementById("solve-status").className =
              "solve-status ready";
            hideMessage();

            renderBoard();
            startTimer();
          };

          function validatePuzzle() {
            for (let i = 0; i < 9; i++) {
              const row = [];
              const col = [];
              const box = [];

              for (let j = 0; j < 9; j++) {
                if (board[i][j] !== 0) {
                  if (row.includes(board[i][j])) return false;
                  row.push(board[i][j]);
                }

                if (board[j][i] !== 0) {
                  if (col.includes(board[j][i])) return false;
                  col.push(board[j][i]);
                }

                const boxRow = Math.floor(i / 3) * 3 + Math.floor(j / 3);
                const boxCol = (i % 3) * 3 + (j % 3);
                if (board[boxRow][boxCol] !== 0) {
                  if (box.includes(board[boxRow][boxCol])) return false;
                  box.push(board[boxRow][boxCol]);
                }
              }
            }
            return true;
          }

          function solveSudoku(grid) {
            for (let row = 0; row < 9; row++) {
              for (let col = 0; col < 9; col++) {
                if (grid[row][col] === 0) {
                  for (let num = 1; num <= 9; num++) {
                    if (isValid(grid, row, col, num)) {
                      grid[row][col] = num;
                      if (solveSudoku(grid)) return true;
                      grid[row][col] = 0;
                    }
                  }
                  return false;
                }
              }
            }
            return true;
          }

          window.solveNext = function () {
            if (!solveStarted || solved) return;

            for (let r = 0; r < 9; r++) {
              for (let c = 0; c < 9; c++) {
                if (board[r][c] === 0) {
                  const num = solution[r][c];
                  moveHistory.push({
                    row: r,
                    col: c,
                    prevValue: 0,
                    newValue: num,
                  });

                  board[r][c] = num;

                  const cell = document.querySelector(
                    '[data-row="' + r + '"][data-col="' + c + '"]'
                  );
                  cell.textContent = num;
                  cell.classList.add("hint");

                  updateNumpadCompletion();

                  if (isBoardFull()) {
                    endGame();
                  }
                  return;
                }
              }
            }
          };

          window.solveAll = function () {
            if (!solveStarted || solved) return;

            for (let r = 0; r < 9; r++) {
              for (let c = 0; c < 9; c++) {
                if (board[r][c] === 0) {
                  const num = solution[r][c];
                  moveHistory.push({
                    row: r,
                    col: c,
                    prevValue: 0,
                    newValue: num,
                  });

                  board[r][c] = num;

                  const cell = document.querySelector(
                    '[data-row="' + r + '"][data-col="' + c + '"]'
                  );
                  cell.textContent = num;
                  cell.classList.add("hint");
                }
              }
            }

            updateNumpadCompletion();
            endGame();
          };

          function updateNumpadCompletion() {
            const counts = Array(10).fill(0);
            for (let r = 0; r < 9; r++) {
              for (let c = 0; c < 9; c++) {
                if (board[r][c] !== 0) {
                  if (solution.length === 0 || board[r][c] === solution[r][c]) {
                    counts[board[r][c]]++;
                  }
                }
              }
            }

            const numpadBtns = document.querySelectorAll(
              ".numpad-btn:not(.erase-btn)"
            );
            numpadBtns.forEach((btn, i) => {
              btn.classList.toggle("completed", counts[i + 1] >= 9);
            });
          }

          function startTimer() {
            stopTimer();
            seconds = 0;
            updateTimer();
            timerInterval = setInterval(() => {
              seconds++;
              updateTimer();
            }, 1000);
          }

          function stopTimer() {
            if (timerInterval) {
              clearInterval(timerInterval);
              timerInterval = null;
            }
          }

          function updateTimer() {
            document.getElementById("timer").textContent = formatTime(seconds);
          }

          function formatTime(secs) {
            const m = Math.floor(secs / 60);
            const s = secs % 60;
            return (
              m.toString().padStart(2, "0") +
              ":" +
              s.toString().padStart(2, "0")
            );
          }

          function showMessage(text, type) {
            const el = document.getElementById("message");
            el.textContent = text;
            el.className = "sudoku-message visible " + type;
          }

          function hideMessage() {
            document.getElementById("message").className = "sudoku-message";
          }

          document.addEventListener("keydown", (e) => {
            if (solved) return;

            if (e.key >= "1" && e.key <= "9") {
              selectNumber(parseInt(e.key));
            } else if (e.key === "Backspace" || e.key === "Delete") {
              eraseCell();
            } else if (e.key === "z" && (e.ctrlKey || e.metaKey)) {
              e.preventDefault();
              undoMove();
            } else if (
              e.key === "ArrowUp" ||
              e.key === "ArrowDown" ||
              e.key === "ArrowLeft" ||
              e.key === "ArrowRight"
            ) {
              e.preventDefault();
              navigateCell(e.key);
            }
          });

          function navigateCell(key) {
            let row = selectedCell ? selectedCell.row : 0;
            let col = selectedCell ? selectedCell.col : 0;

            switch (key) {
              case "ArrowUp":
                row = Math.max(0, row - 1);
                break;
              case "ArrowDown":
                row = Math.min(8, row + 1);
                break;
              case "ArrowLeft":
                col = Math.max(0, col - 1);
                break;
              case "ArrowRight":
                col = Math.min(8, col + 1);
                break;
            }

            selectCell(row, col);

            const cell = document.querySelector(
              '[data-row="' + row + '"][data-col="' + col + '"]'
            );
            if (!fixed[row][col]) {
              cell.classList.add("selected");
            }
          }

          document.addEventListener("DOMContentLoaded", init);
        })();
      </script>
    </main>

    <footer>
      <div class="footer-content">
        <p>&copy; 2025 tools.pllip.com</p>
        <div class="lang-switcher">
          <a href="/sudoku/" class="lang-btn">ÌïúÍµ≠Ïñ¥</a>
          <a href="/en/sudoku/" class="lang-btn active">English</a>
        </div>
      </div>
    </footer>

    <script>
      (function () {
        // Nav scroll arrows
        const menu = document.getElementById("nav-menu");
        const prevBtn = document.querySelector(".nav-prev");
        const nextBtn = document.querySelector(".nav-next");

        function updateArrows() {
          const needsScroll = menu.scrollWidth > menu.clientWidth;
          const atStart = menu.scrollLeft <= 0;
          const atEnd =
            menu.scrollLeft >= menu.scrollWidth - menu.clientWidth - 1;

          if (needsScroll) {
            prevBtn.classList.add("visible");
            nextBtn.classList.add("visible");
            prevBtn.classList.toggle("hidden", atStart);
            nextBtn.classList.toggle("hidden", atEnd);
          } else {
            prevBtn.classList.remove("visible");
            nextBtn.classList.remove("visible");
          }
        }

        prevBtn.addEventListener("click", () =>
          menu.scrollBy({ left: -150, behavior: "smooth" })
        );
        nextBtn.addEventListener("click", () =>
          menu.scrollBy({ left: 150, behavior: "smooth" })
        );
        menu.addEventListener("scroll", updateArrows);
        window.addEventListener("resize", updateArrows);

        // Scroll to active menu item on load
        const activeItem = menu.querySelector("a.active");
        if (activeItem) {
          const li = activeItem.parentElement;
          const menuRect = menu.getBoundingClientRect();
          const liRect = li.getBoundingClientRect();
          const scrollLeft =
            li.offsetLeft - menuRect.width / 2 + liRect.width / 2;
          menu.scrollLeft = Math.max(0, scrollLeft);
        }
        updateArrows();

        // Header search dropdown
        const searchBtn = document.getElementById("search-btn");
        const dropdown = document.getElementById("search-dropdown");
        const searchInput = document.getElementById("header-search");
        const results = document.getElementById("search-results");
        const items = results.querySelectorAll("li");

        searchBtn.addEventListener("click", (e) => {
          e.stopPropagation();
          dropdown.classList.toggle("open");
          if (dropdown.classList.contains("open")) {
            searchInput.focus();
          }
        });

        document.addEventListener("click", (e) => {
          if (!dropdown.contains(e.target) && e.target !== searchBtn) {
            dropdown.classList.remove("open");
          }
        });

        searchInput.addEventListener("input", () => {
          const q = searchInput.value.toLowerCase().trim();
          let visible = 0;
          items.forEach((li) => {
            const a = li.querySelector("a");
            const text = a.textContent.toLowerCase();
            const keywords = (a.dataset.keywords || "").toLowerCase();
            const match = !q || text.includes(q) || keywords.includes(q);
            li.classList.toggle("hidden", !match);
            if (match) visible++;
          });
        });

        // Keyboard shortcut: Cmd/Ctrl + K
        document.addEventListener("keydown", (e) => {
          if ((e.metaKey || e.ctrlKey) && e.key === "k") {
            e.preventDefault();
            dropdown.classList.add("open");
            searchInput.focus();
          }
          if (e.key === "Escape") {
            dropdown.classList.remove("open");
          }
        });
      })();
    </script>
    <script
      defer
      src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015"
      integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ=="
      data-cf-beacon='{"version":"2024.11.0","token":"a47e96a534854c899db066813b9421c4","r":1,"server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}'
      crossorigin="anonymous"
    ></script>
  </body>
</html>
